"use strict";
const mongoose = require('mongoose');
const passport = require('passport');
const LocalStrategy = require('passport-local');
const Users = mongoose.model('Users');
passport.use(new LocalStrategy({
    usernameField: 'user[email]',
    passwordField: 'user[password]',
}, async (email, password, done) => {
    Users.findOne({ email })
        .then((user) => {
        if (!user || !user.validatePassword(password)) {
            return done(null, false, { errors: { 'email or password': 'is invalid' } });
        }
        return done(null, user);
    }).catch(done);
}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFzc3BvcnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvY29uZmlnL3Bhc3Nwb3J0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxNQUFNLFFBQVEsR0FBRyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUM7QUFDckMsTUFBTSxRQUFRLEdBQUcsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQ3JDLE1BQU0sYUFBYSxHQUFHLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0FBRWhELE1BQU0sS0FBSyxHQUFHLFFBQVEsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7QUFFdEMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxJQUFJLGFBQWEsQ0FBQztJQUM3QixhQUFhLEVBQUUsYUFBYTtJQUM1QixhQUFhLEVBQUUsZ0JBQWdCO0NBRWhDLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLEVBQUU7SUFDakMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDO1NBQ3JCLElBQUksQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFO1FBRWIsSUFBRyxDQUFDLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUM1QyxPQUFPLElBQUksQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLEVBQUUsTUFBTSxFQUFFLEVBQUUsbUJBQW1CLEVBQUUsWUFBWSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1NBQzdFO1FBQ0QsT0FBTyxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQzFCLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNuQixDQUFDLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xyXG5jb25zdCBwYXNzcG9ydCA9IHJlcXVpcmUoJ3Bhc3Nwb3J0Jyk7XHJcbmNvbnN0IExvY2FsU3RyYXRlZ3kgPSByZXF1aXJlKCdwYXNzcG9ydC1sb2NhbCcpO1xyXG5cclxuY29uc3QgVXNlcnMgPSBtb25nb29zZS5tb2RlbCgnVXNlcnMnKTtcclxuLy9AdHMtaWdub3JlXHJcbnBhc3Nwb3J0LnVzZShuZXcgTG9jYWxTdHJhdGVneSh7XHJcbiAgdXNlcm5hbWVGaWVsZDogJ3VzZXJbZW1haWxdJyxcclxuICBwYXNzd29yZEZpZWxkOiAndXNlcltwYXNzd29yZF0nLFxyXG4gIC8vQHRzLWlnbm9yZVxyXG59LCBhc3luYyAoZW1haWwsIHBhc3N3b3JkLCBkb25lKSA9PiB7XHJcbiAgVXNlcnMuZmluZE9uZSh7IGVtYWlsIH0pXHJcbiAgICAudGhlbigodXNlcikgPT4ge1xyXG4gICAgICAgIC8vQHRzLWlnbm9yZVxyXG4gICAgICBpZighdXNlciB8fCAhdXNlci52YWxpZGF0ZVBhc3N3b3JkKHBhc3N3b3JkKSkge1xyXG4gICAgICAgIHJldHVybiBkb25lKG51bGwsIGZhbHNlLCB7IGVycm9yczogeyAnZW1haWwgb3IgcGFzc3dvcmQnOiAnaXMgaW52YWxpZCcgfSB9KTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gZG9uZShudWxsLCB1c2VyKTtcclxuICAgIH0pLmNhdGNoKGRvbmUpO1xyXG59KSk7Il19